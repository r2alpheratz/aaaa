<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MenuPageMgn">


	<select id="selectMenuPageListCount" 	resultType="int">
         SELECT  COUNT(*)
		FROM TB_FR_MENU_PAGE_INFO

	WHERE 1=1
	 <if test="menuSq  != null">
		AND MENU_SQ = #{menuSq}
       </if>
        <if test="pageUrl  != null">
		 AND PAGE_URL = #{pageUrl}
       </if>


	</select>

	<select id="selectMenuPageList" 	resultType="menuPageInfoVo">
	  <if test="readcount  != null and readcount !=''">
		SELECT T2.*
		FROM
		(SELECT row_number() over(order by MENU_SQ) AS NUM,
		T1.*
		FROM(

	 </if>

	 SELECT  MENU_PAGE_SQ,  MENU_SQ,  READ_YN, UPDATE_YN, EXECUTE_YN,   PAGE_URL,  DESCRIPTION,  USE_YN
	FROM  TB_FR_MENU_PAGE_INFO
	WHERE 1=1
	 <if test="menuSq  != null">
		AND MENU_SQ = #{menuSq}
       </if>
        <if test="pageUrl  != null">
		 AND PAGE_URL = #{pageUrl}
       </if>
	 ORDER BY MENU_PAGE_SQ DESC

	  <if test="readcount  != null and readcount !=''">
<![CDATA[
	  	) T1
		)T2
		WHERE NUM >  #{readindex} AND NUM <= #{readcount} + #{readindex}
		 ]]>
	 </if>
	</select>



<insert id="insertMenuPageInfo" parameterType="menuPageInfoVo">
INSERT INTO TB_FR_MENU_PAGE_INFO
( MENU_PAGE_SQ, MENU_SQ, READ_YN, UPDATE_YN, EXECUTE_YN, PAGE_URL, DESCRIPTION, USE_YN , CREATE_USR_ID, CREATE_DT)
VALUES (#{menuPageSq},
 #{menuSq}, #{readYn},  #{updateYn},  #{executeYn},  #{pageUrl}, #{description} ,
#{useYn},   #{createUsrId, jdbcType=VARCHAR}, systimestamp )
</insert>



<update id="updateMenuPageInfo"  parameterType="menuPageInfoVo">
	UPDATE TB_FR_MENU_PAGE_INFO
    SET

    	READ_YN = #{readYn},

    	UPDATE_YN = #{updateYn},

    	EXECUTE_YN = #{executeYn},

    <if test="pageUrl  != null and pageUrl !=''">
        PAGE_URL  =  #{pageUrl},
    </if>
    <if test="description  != null and description !=''">
    	DESCRIPTION  =  #{description},
    </if>
    <if test="useYn  != null and useYn !=''">
    	USE_YN  =  #{useYn},
     </if>
          	  UPDATE_USR_ID =  #{updateUsrId},
               UPDATE_DT =   systimestamp
               WHERE MENU_PAGE_SQ = #{menuPageSq}
</update>


<delete id="deleteMenuPageInfo"  parameterType="menuPageInfoVo">
  DELETE FROM TB_FR_MENU_PAGE_INFO
       <choose>
         <when test="menuPageSq  != null and menuPageSq !=''">
               WHERE MENU_PAGE_SQ = #{menuPageSq}
             </when>
             <otherwise>
              WHERE     MENU_SQ = #{menuSq}
                </otherwise>
                </choose>
</delete>

	<select id="getMaxIdSeq" resultType="string">
select  MAX(SUBSTR(MENU_PAGE_SQ , 5 , 10)) AS   SEQ from TB_FR_MENU_PAGE_INFO
	</select>
</mapper>


